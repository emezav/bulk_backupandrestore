define ("tool_bulk_backupandrestore/backup_category",["jquery","core/config"],function(a,b){var c="",d="",e="",f=0,g=0,h=0,i=0,j=0,k=function(){var b=a("#course-table");c=b.data("session");d=b.data("key");e=b.data("outdir");i=b.data("backupusers");j=b.data("backupblocks");var h=a(".course-row");f=h.length;a(".progress-bar").attr("aria-valuenow",0);a(".progress-bar").attr("style","width: 0");a(".progress-bar").html("0%");a(".progress").removeClass("d-none");if(0<f){g=1;l()}},l=function(){h=g;var k=a(".course-row-"+h).data("course");if(0<h&&h<=f){var m=b.wwwroot+"/admin/tool/bulk_backupandrestore/backup_course.php";a("#course-"+k).addClass("text-primary");a("#course-"+k).addClass("border-primary");a("#course-"+k+" > td.status").html("");a.ajax({type:"POST",url:m,dataType:"json",data:{id:k,sesskey:c,key:d,outdir:e,backupusers:i,backupblocks:j,last:h==f?!0:!1},success:function success(b){a("#course-"+k).removeClass("border-primary");a("#course-"+k).removeClass("text-primary");var c=Math.floor(100*(g/f));a(".progress-bar").attr("aria-valuenow",c);a(".progress-bar").attr("style","width: "+c+"%");a(".progress-bar").html(c+"%");a("#course-"+k+" > td.status").html(b.message);if(!0==b.status){a("#course-"+k).addClass("text-success")}else{a("#course-"+k).addClass("text-danger")}if(h<f){g++;l()}else{a(".progress").hide();a(".result").html(b.result)}},error:function error(){a("#course-"+k).removeClass("border-primary");a("#course-"+k).removeClass("text-primary");a("#course-"+k).addClass("text-danger");var b=Math.floor(100*(g/f));a(".progress-bar").attr("aria-valuenow",b);a(".progress-bar").attr("style","width: "+b+"%");a(".progress-bar").html(b+"%");if(h<=f){g++;l()}else{a(".progress").hide()}}})}};return{init:function init(){a("#backup_category").on("click",function(){k()})}}});
//# sourceMappingURL=backup_category.min.js.map
